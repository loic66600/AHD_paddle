---
import { withBase } from '../../utils/url';

const homeLink = withBase('/');
const logoSrc = withBase('/images/logo_blanc.png');
const menuItems = [
	{ href: withBase('/#univers'), label: '> Univers AHD' },
	{ href: withBase('/#gamme'), label: 'Collection' },
	{ href: withBase('/#histoire'), label: 'Histoire' },
	{ href: withBase('/#decouvrir'), label: 'DÃ©couvrir' }
];
---

<div class="relative">
	<input id="ahd-drawer-toggle" type="checkbox" class="peer sr-only" aria-hidden="true" />

	<!-- Navigation principale avec menu fixe -->
	<header
		id="ahd-global-nav"
		class="nav-dark fixed inset-x-0 top-0 z-40 grid grid-cols-[auto_1fr_auto] items-center gap-4 px-6 py-5 md:px-12"
	>
		<label
			id="ahd-menu-button"
			for="ahd-drawer-toggle"
			class="nav-trigger text-sm uppercase tracking-[0.35em] focus:outline-none cursor-pointer"
			aria-controls="ahd-drawer"
			aria-expanded="false"
		>
			Menu
		</label>
		<a href={homeLink} class="nav-brand flex flex-col items-center gap-3 justify-self-center focus:outline-none">
			<img id="ahd-nav-logo" src={logoSrc} alt="AHD" class="nav-logo h-9 w-auto" loading="lazy" />
			<p class="nav-tagline text-xs uppercase tracking-[0.5em]">AHD Paddle Division</p>
		</a>
		<div class="w-16"></div>
	</header>

	<div
		id="ahd-drawer"
		class="fixed inset-y-0 left-0 z-50 w-72 max-w-xs -translate-x-full transform bg-midnight/95 px-8 py-12 transition-transform duration-500 will-change-transform peer-checked:translate-x-0"
	>
		<nav class="flex flex-col gap-8 text-sm uppercase tracking-[0.35em] text-foam/80">
			{menuItems.map((item) => (
				<a href={item.href}>{item.label}</a>
			))}
		</nav>
	</div>

	<label
		for="ahd-drawer-toggle"
		class="fixed inset-0 z-40 bg-black/50 opacity-0 pointer-events-none transition-opacity duration-300 peer-checked:opacity-100 peer-checked:pointer-events-auto"
		aria-hidden="true"
	></label>

	<script type="module">
		const drawerToggle = document.getElementById('ahd-drawer-toggle');
		const drawerLinks = document.querySelectorAll('#ahd-drawer a');
		const menuButton = document.getElementById('ahd-menu-button');

		if (drawerToggle && menuButton) {
			menuButton.setAttribute('aria-expanded', String(drawerToggle.checked));
			drawerToggle.addEventListener('change', () => {
				menuButton.setAttribute('aria-expanded', String(drawerToggle.checked));
			});
		}

		if (drawerToggle && drawerLinks.length) {
			const closeMenu = () => {
				drawerToggle.checked = false;
				if (menuButton) {
					menuButton.setAttribute('aria-expanded', 'false');
				}
			};

			drawerLinks.forEach((link) => {
				link.addEventListener('click', closeMenu);
			});
		}
	</script>
</div>
