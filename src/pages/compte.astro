---
import Layout from '../layouts/Layout.astro';
import { withBase } from '../utils/url';
---

<Layout title="AHD Paddle | Mon compte">
  <main class="bg-white pb-24" data-bg="#ffffff" data-nav="light">
    <section class="container pt-28 md:pt-32 text-midnight">
      <div class="mx-auto flex w-full max-w-3xl flex-col gap-10">
        <div class="space-y-4 text-center">
          <p class="text-xs font-semibold uppercase tracking-[0.35em] text-midnight/60">Mon compte</p>
          <h1 class="text-3xl md:text-4xl font-semibold">Coordonn√©es personnelles</h1>
          <p class="text-sm md:text-base text-midnight/60">
            Renseignez vos informations. Vous pourrez les modifier √† tout moment.
          </p>
          <div class="flex flex-wrap items-center justify-center gap-3 pt-2">
            <a
              href={withBase('/commandes')}
              class="rounded-full border border-midnight/20 px-5 py-2 text-xs font-semibold uppercase tracking-[0.3em] text-midnight/70 transition hover:border-midnight hover:text-midnight"
            >
              Toutes mes commandes
            </a>
            <a
              href={withBase('/')}
              class="rounded-full border border-midnight/20 px-5 py-2 text-xs font-semibold uppercase tracking-[0.3em] text-midnight/70 transition hover:border-midnight hover:text-midnight"
            >
              Retour √† l‚Äôaccueil
            </a>
          </div>
        </div>

        <form class="space-y-8 rounded-[2.5rem] border border-midnight/10 bg-white/70 p-8 shadow-[0_24px_60px_rgba(15,23,42,0.08)]">
          <div class="grid gap-6 md:grid-cols-2">
            <div class="space-y-2">
              <label for="account-firstname" class="text-xs font-semibold text-midnight/70">Pr√©nom</label>
              <input
                id="account-firstname"
                type="text"
                placeholder="Votre pr√©nom"
                class="w-full rounded-full border border-midnight/20 bg-slate-50 px-4 py-3 text-sm text-midnight placeholder:text-midnight/40 focus:border-midnight focus:outline-none"
              />
            </div>
            <div class="space-y-2">
              <label for="account-lastname" class="text-xs font-semibold text-midnight/70">Nom</label>
              <input
                id="account-lastname"
                type="text"
                placeholder="Votre nom"
                class="w-full rounded-full border border-midnight/20 bg-slate-50 px-4 py-3 text-sm text-midnight placeholder:text-midnight/40 focus:border-midnight focus:outline-none"
              />
            </div>
          </div>

          <div class="grid gap-6 md:grid-cols-2">
            <div class="space-y-2">
              <label for="account-email-main" class="text-xs font-semibold text-midnight/70">E-mail</label>
              <input
                id="account-email-main"
                type="email"
                placeholder="email@exemple.com"
                class="w-full rounded-full border border-midnight/20 bg-slate-50 px-4 py-3 text-sm text-midnight placeholder:text-midnight/40 focus:border-midnight focus:outline-none"
              />
            </div>
            <div class="space-y-2">
              <label for="account-phone" class="text-xs font-semibold text-midnight/70">T√©l√©phone</label>
              <input
                id="account-phone"
                type="tel"
                placeholder="+33 6 12 34 56 78"
                class="w-full rounded-full border border-midnight/20 bg-slate-50 px-4 py-3 text-sm text-midnight placeholder:text-midnight/40 focus:border-midnight focus:outline-none"
              />
            </div>
          </div>

          <div class="space-y-2">
            <label for="account-address" class="text-xs font-semibold text-midnight/70">Adresse</label>
            <input
              id="account-address"
              type="text"
              placeholder="Adresse et compl√©ment"
              class="w-full rounded-full border border-midnight/20 bg-slate-50 px-4 py-3 text-sm text-midnight placeholder:text-midnight/40 focus:border-midnight focus:outline-none"
            />
          </div>

          <div class="grid gap-6 md:grid-cols-3">
            <div class="space-y-2">
              <label for="account-zip" class="text-xs font-semibold text-midnight/70">Code postal</label>
              <input
                id="account-zip"
                type="text"
                placeholder="Code postal"
                class="w-full rounded-full border border-midnight/20 bg-slate-50 px-4 py-3 text-sm text-midnight placeholder:text-midnight/40 focus:border-midnight focus:outline-none"
              />
            </div>
            <div class="space-y-2">
              <label for="account-city" class="text-xs font-semibold text-midnight/70">Ville</label>
              <input
                id="account-city"
                type="text"
                placeholder="Ville"
                class="w-full rounded-full border border-midnight/20 bg-slate-50 px-4 py-3 text-sm text-midnight placeholder:text-midnight/40 focus:border-midnight focus:outline-none"
              />
            </div>
            <div class="space-y-2">
              <label for="account-country" class="text-xs font-semibold text-midnight/70">Pays</label>
              <input
                id="account-country"
                type="text"
                placeholder="Pays"
                class="w-full rounded-full border border-midnight/20 bg-slate-50 px-4 py-3 text-sm text-midnight placeholder:text-midnight/40 focus:border-midnight focus:outline-none"
              />
            </div>
          </div>

          <div class="flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between">
            <p class="text-xs text-midnight/50">Vous pourrez modifier ces informations plus tard.</p>
            <button
              type="submit"
              class="rounded-full bg-midnight px-6 py-3 text-xs font-semibold uppercase tracking-[0.35em] text-white"
            >
              Enregistrer
            </button>
          </div>
        </form>
      </div>
    </section>
  </main>

  <script type="module" is:inline>
    const nav = document.getElementById('ahd-global-nav');
    if (nav) {
      nav.classList.add('nav-dark');
      nav.classList.remove('nav-light');
      nav.style.setProperty('--nav-bg', 'rgba(1, 1, 4, 0.65)');
      nav.style.setProperty('--nav-border', 'rgba(255, 255, 255, 0.15)');
      nav.style.setProperty('--nav-foreground', 'rgba(255, 255, 255, 0.92)');
      nav.style.setProperty('--nav-hover', '#ffffff');
    }

    // R√©cup√©rer et pr√©-remplir les donn√©es d'inscription
    const getStorage = () => {
      try {
        return window.localStorage;
      } catch (error) {
        return null;
      }
    };

    const loadUserData = () => {
      const storage = getStorage();
      if (!storage) return;

      // R√©cup√©rer les donn√©es temporaires d'inscription
      const signupData = storage.getItem('ahd-signup-data');
      if (signupData) {
        try {
          const data = JSON.parse(signupData);
          console.log('üìÑ Loading signup data:', data);
          
          // Pr√©-remplir les champs
          const firstnameInput = document.getElementById('account-firstname');
          const lastnameInput = document.getElementById('account-lastname');
          const emailInput = document.getElementById('account-email');
          
          if (firstnameInput && data.firstname) {
            firstnameInput.value = data.firstname;
            console.log('‚úÖ Firstname filled:', data.firstname);
          }
          if (lastnameInput && data.lastname) {
            lastnameInput.value = data.lastname;
            console.log('‚úÖ Lastname filled:', data.lastname);
          }
          if (emailInput && data.email) {
            emailInput.value = data.email;
            console.log('‚úÖ Email filled:', data.email);
          }
          
          // Nettoyer les donn√©es temporaires apr√®s usage
          storage.removeItem('ahd-signup-data');
          console.log('üßπ Temporary signup data cleaned');
        } catch (error) {
          console.error('‚ùå Error loading signup data:', error);
        }
      } else {
        console.log('‚ÑπÔ∏è No signup data found - direct page access');
      }
    };

    // Charger les donn√©es au chargement de la page
    document.addEventListener('DOMContentLoaded', loadUserData);
  </script>
</Layout>
